# Chebyshev-Tucker 3D Interpolation Experiment

## Goal

Benchmark Chebyshev polynomial interpolation with Tucker tensor decomposition
against B-spline interpolation for the dimensionless EEP function
`eep(x, τ', ln κ)`. Test whether Chebyshev breaks the B-spline accuracy wall
found during PR 386.

## Motivation

PR 386 found that B-spline interpolation on the 3D dimensionless surface hits
an accuracy plateau — adding more grid points no longer improves error. The
wide ln κ axis (~8 units) causes oscillation, requiring domain segmentation as
a workaround. Chebyshev interpolation's exponential convergence for smooth
functions should overcome this limitation.

## Design Decisions

- **Test function:** Dimensionless EEP directly (not analytic test functions).
  Ground truth via `reference_eep()` PDE solves at `GridAccuracyProfile::Ultra`
  (tol=5e-6, min_spatial=401, max_spatial=5000, max_time_steps=20000).
- **Tensor structure:** Low-rank Tucker decomposition from the start, testing
  the Glau et al. claim that parameter cross-interactions are weak.
- **SVD dependency:** Eigen (header-only) via Bazel. Experiment-only — not
  committed to production.
- **Scope:** Standalone proof-of-concept + head-to-head benchmark. No
  production integration, no derivatives, no adaptive refinement, no q > 0.
- **Error metric:** EEP absolute error only (not downstream IV error). EEP
  isolates interpolation accuracy from Newton convergence behavior.

## Architecture

### Chebyshev Interpolation

Chebyshev-Gauss-Lobatto nodes on [-1, 1]. A degree-n polynomial uses n+1
nodes:

    xⱼ = cos(jπ / n),  j = 0, ..., n    (n+1 nodes for degree n)

Mapped to each physical axis via affine transform. Barycentric interpolation
for O(n) evaluation without forming the polynomial explicitly:

    p(x) = Σⱼ (wⱼ/(x - xⱼ)) · fⱼ  /  Σⱼ (wⱼ/(x - xⱼ))

### Tucker Decomposition (HOSVD)

Full 3D tensor T of shape (n₀+1, n₁+1, n₂+1) decomposed as:

    T ≈ G ×₀ U₀ ×₁ U₁ ×₂ U₂

where Uₖ is (nₖ+1) × Rₖ (orthogonal factor matrix) and G is R₀ × R₁ × R₂
(core tensor). Ranks Rₖ chosen by singular value threshold (σᵢ/σ₀ < ε).

Algorithm:
1. Mode-k unfolding of T into matrix (nₖ+1, product of other dims)
2. SVD via Eigen's JacobiSVD, truncate to Rₖ
3. Core tensor: G = T ×₀ U₀ᵀ ×₁ U₁ᵀ ×₂ U₂ᵀ

### Query-Time Evaluation

1. Barycentric Chebyshev weights for each axis: O(n) per axis
2. Contract weights with factor matrices Uₖ: O(n × R) per axis
3. Contract with core tensor G: O(R³)
4. Total: O(3nR + R³) vs O(n³) full tensor

### File Layout

Source files under `src/option/table/dimensionless/`:

- `chebyshev_nodes.hpp` — Node generation + barycentric weights
- `tucker_decomposition.hpp` — HOSVD via Eigen SVD
- `chebyshev_tucker.hpp` — Combined interpolant: build + eval

Test and benchmark files in their standard top-level directories:

- `tests/chebyshev_tucker_test.cc` — Accuracy tests against reference EEP
- `benchmarks/chebyshev_vs_bspline.cc` — Head-to-head comparison

## Benchmark Design

**Controlled variable:** Number of sample points per axis `num_pts`, swept
from 6 to 30. Both methods receive the same `num_pts` sample points along each
axis, so the PDE budget is identical: `num_pts` solves along the ln κ axis,
with x and τ' resampled from PDE snapshots.

- Chebyshev uses `num_pts` Chebyshev-Gauss-Lobatto nodes (degree = num_pts-1)
- B-spline uses `num_pts` uniformly-spaced knots with headroom

**Three interpolant configurations:**
1. **B-spline (cubic, unsegmented)** — Current approach, single surface
2. **Chebyshev full tensor** — No Tucker compression, isolates basis effect
3. **Chebyshev-Tucker** — HOSVD compression with threshold sweep

Configuration 2 separates the Chebyshev basis improvement from Tucker
compression error. If Chebyshev-full breaks the wall but Chebyshev-Tucker
doesn't, the issue is rank truncation, not the basis.

**Error evaluation:** 500 probes generated by seeded LHS (seed=42) in the
physical domain, plus 8 corner points and 12 edge midpoints (total 520).
Deterministic and reproducible across runs.

**Measurements per configuration per num_pts:**
- Max and mean absolute EEP error over all probes
- Tucker ranks per mode and truncation threshold (config 3 only)
- Evaluation time per query (ns, median of 10k queries)

**Expected outcome:**
- B-spline error plateaus at some num_pts (the "wall")
- Chebyshev-full error continues dropping exponentially past that point
- Chebyshev-Tucker matches Chebyshev-full at low ranks, confirming weak
  cross-interactions

**Reference truth:** Fresh PDE solves using `GridAccuracyProfile::Ultra`
via `reference_eep()`. Settings are deterministic (same grid/tolerance
parameters yield identical results).

## Out of Scope

- Production integration (replacing BSplineND<3>)
- Derivatives / vega via Chebyshev
- Adaptive node placement
- q > 0 handling
- Eigen in production builds
