cc_test(
    name = "grid_test",
    srcs = ["grid_test.cc"],
    deps = [
        "//src/cpp:grid",
        "@googletest//:gtest_main",
    ],
    copts = ["-std=c++20"],
)

cc_test(
    name = "multigrid_test",
    srcs = ["multigrid_test.cc"],
    deps = [
        "//src/cpp:multigrid",
        "//src/cpp:grid",
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
    copts = ["-std=c++20", "-Wall", "-Wextra"],
)

cc_test(
    name = "boundary_conditions_test",
    srcs = ["boundary_conditions_test.cc"],
    deps = [
        "//src/cpp:boundary_conditions",
        "@googletest//:gtest_main",
    ],
    copts = ["-std=c++20"],
)

cc_test(
    name = "cache_config_test",
    srcs = ["cache_config_test.cc"],
    deps = [
        "//src/cpp:cache_config",
        "@googletest//:gtest_main",
    ],
    copts = ["-std=c++20"],
)

cc_test(
    name = "workspace_test",
    srcs = ["workspace_test.cc"],
    deps = [
        "//src/cpp:workspace",
        "//src/cpp:grid",
        "@googletest//:gtest_main",
    ],
    copts = ["-std=c++20"],
)

cc_test(
    name = "root_finding_test",
    srcs = ["root_finding_test.cc"],
    deps = [
        "//src/cpp:root_finding",
        "@googletest//:gtest_main",
    ],
    copts = ["-std=c++20"],
)

cc_test(
    name = "newton_workspace_test",
    srcs = ["newton_workspace_test.cc"],
    deps = [
        "//src/cpp:newton_workspace",
        "//src/cpp:workspace",
        "//src/cpp:grid",
        "@googletest//:gtest_main",
    ],
    copts = ["-std=c++20"],
)

cc_test(
    name = "newton_solver_test",
    srcs = ["newton_solver_test.cc"],
    deps = [
        "//src/cpp:newton_solver",
        "//src/cpp:root_finding",
        "//src/cpp:workspace",
        "//src/cpp:boundary_conditions",
        "//src/cpp:spatial_operators",
        "//src/cpp:grid",
        "@googletest//:gtest_main",
    ],
    copts = ["-std=c++20"],
)

cc_test(
    name = "spatial_operators_test",
    srcs = ["spatial_operators_test.cc"],
    deps = [
        "//src/cpp:spatial_operators",
        "//src/cpp:workspace",
        "//src/cpp:grid",
        "@googletest//:gtest_main",
    ],
    copts = ["-std=c++20"],
)

cc_test(
    name = "pde_solver_test",
    srcs = ["pde_solver_test.cc"],
    deps = [
        "//src/cpp:pde_solver",
        "//src/cpp:spatial_operators",
        "//src/cpp:boundary_conditions",
        "//src/cpp:root_finding",
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
    copts = ["-std=c++20", "-Wall", "-Wextra"],
)

cc_test(
    name = "cubic_spline_test",
    srcs = ["cubic_spline_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:pde_solver",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "grid_generation_test",
    srcs = ["grid_generation_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:grid_generation",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "grid_presets_test",
    srcs = ["grid_presets_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:grid_presets",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "stability_test",
    srcs = ["stability_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:pde_solver",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "brent_test",
    srcs = ["brent_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:implied_volatility",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "lets_be_rational_test",
    srcs = ["lets_be_rational_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:lets_be_rational",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "implied_volatility_test",
    srcs = ["implied_volatility_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:implied_volatility",
        "//src:american_option",
        "//src:price_table",
        "@googletest//:gtest_main",
    ],
    tags = ["manual", "slow"],  # Excluded from fast CI - takes ~300s due to FDM calculations
)

cc_test(
    name = "tridiagonal_test",
    srcs = ["tridiagonal_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:cubic_spline",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "american_option_test",
    srcs = ["american_option_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:american_option",
        "//src:implied_volatility",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "unified_grid_test",
    srcs = ["unified_grid_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:american_option",
        "//src:price_table",
        "//src:pde_solver",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "adaptive_accuracy_test",
    srcs = ["adaptive_accuracy_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:validation",
        "//src:price_table",
        "//src:american_option",
        "@googletest//:gtest_main",
    ],
    tags = ["manual", "slow"],  # Disabled in fast CI: mostly slow tests + known failures (issue #61)
)

cc_test(
    name = "interpolation_test",
    srcs = ["interpolation_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:interp_cubic",
        "//src:iv_surface",
        "//src:price_table",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "cubic_interp_4d_5d_test",
    srcs = ["cubic_interp_4d_5d_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:interp_cubic",
        "//src:price_table",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "interpolation_workspace_test",
    srcs = ["interpolation_workspace_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:interp_cubic",
        "//src:iv_surface",
        "//src:price_table",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "price_table_test",
    size = "small",
    srcs = ["price_table_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:price_table",
        "//src:american_option",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "price_table_slow_test",
    size = "large",
    srcs = ["price_table_slow_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:price_table",
        "//src:american_option",
        "@googletest//:gtest_main",
    ],
    tags = ["manual", "slow"],  # Disabled in fast CI: precomputes 1200 grid points (~5s)
)

cc_test(
    name = "coordinate_transform_test",
    size = "small",
    srcs = ["coordinate_transform_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:price_table",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "memory_layout_test",
    size = "small",
    srcs = ["memory_layout_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:price_table",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "diagnostic_interp_test",
    size = "small",
    srcs = ["diagnostic_interp_test.cc"],
    copts = ["-std=c++17", "-Wall", "-Wextra"],
    deps = [
        "//src:price_table",
        "//src:american_option",
        "@googletest//:gtest_main",
    ],
)

cc_test(
    name = "integration_5d_price_table_test",
    srcs = ["integration_5d_price_table_test.cc"],
    deps = [
        "//src/cpp:multigrid",
        "//src/cpp:workspace",
        "//src/cpp:spatial_operators",
        "//src/cpp:grid",
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
    copts = ["-std=c++20", "-Wall", "-Wextra"],
)

cc_test(
    name = "time_domain_test",
    srcs = ["time_domain_test.cc"],
    deps = [
        "//src/cpp:time_domain",
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
    copts = ["-std=c++20", "-Wall", "-Wextra"],
)

cc_test(
    name = "trbdf2_config_test",
    srcs = ["trbdf2_config_test.cc"],
    deps = [
        "//src/cpp:trbdf2_config",
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
    copts = ["-std=c++20", "-Wall", "-Wextra"],
)

cc_test(
    name = "tridiagonal_solver_test",
    srcs = ["tridiagonal_solver_test.cc"],
    deps = [
        "//src/cpp:tridiagonal_solver",
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
    copts = ["-std=c++20", "-Wall", "-Wextra"],
)

# Test suites defined for convenience
# Fast tests: bazel test //tests/... --test_tag_filters=-manual,-slow
# Slow tests: bazel test //tests/... --test_tag_filters=slow
